<!DOCTYPE html><html><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Next2D | Framework API Documentation</title><meta itemprop="name" content="Next2D | Framework API Documentation"><meta itemprop="description" content="Framework API Documentation."><meta itemprop="image" content="https://next2d.app/assets/img/ogp.png"><meta property="og:url" content="https://next2d.app/"><meta property="og:type" content="website"><meta property="og:title" content="Next2D | Framework API Documentation"><meta property="og:description" content="Framework API Documentation."><meta property="og:image" content="https://next2d.app/assets/img/ogp.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Next2D | Framework API Documentation"><meta name="twitter:description" content="Framework API Documentation."><meta name="twitter:image" content="https://next2d.app/assets/img/ogp.png"><link href="../../../assets/img/favicon.png" rel="icon"><link href="../../../assets/img/apple-touch-icon.png" rel="apple-touch-icon"><link href="../../../assets/vendor/aos/aos.css" rel="stylesheet"><link href="../../../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"><link href="../../../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet"><link href="../../../assets/css/main.min.css" rel="stylesheet"><link href="../../../assets/css/jsdoc.min.css" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=G-8GJWF4S3RH"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag("js", new Date());
        gtag("config", "G-8GJWF4S3RH");</script><script data-ad-client="ca-pub-5673019255498912" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><header id="header" class="header fixed-top d-flex align-items-center"><div class="container d-flex align-items-center justify-content-between"><div id="logo"><a href="../../../en"><img loading="lazy" src="../../../assets/img/logo.svg" alt="Next2D Rendering Engine, NoCode Tool, Underlying Framework." title="Next2D Rendering Engine, NoCode Tool, Underlying Framework."></a></div><nav id="navbar" class="navbar"><ul class="list-unstyled"><li><a class="nav-link scrollto" href="../../../en/#get-started">Home</a></li><li class="dropdown"><a class="nav-link scrollto" href="#player-list"><span>Player</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="https://github.com/Next2D/Player" target="_blank">GitHub</a></li><li><a href="../../../en/docs/player">API Docs</a></li><li><a href="../../../en/reference/player">Reference</a></li><li><a href="../../../en/#player">Features</a></li></ul></li><li class="dropdown"><a class="nav-link scrollto" href="#nocode-tool-list"><span>NoCode Tool</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="https://tool.next2d.app" target="_blank">Web Site</a></li><li><a href="../../../en/usage">Usage</a></li><li><a href="https://www.youtube.com/channel/UCKWvYSKSa8huzkr9T6GAPUw/videos" target="_blank">YouTube</a></li><li><a href="../../../en/docs/tool">API Docs</a></li><li><a href="../../../en/#tool">Features</a></li><li><a href="https://github.com/Next2D/tool.next2d.app/tree/develop" target="_blank">GitHub</a></li></ul></li><li class="dropdown"><a class="nav-link scrollto" href="#framework-list"><span>Framework</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="https://github.com/Next2D/Framework" target="_blank">GitHub</a></li><li><a href="../../../en/docs/framework">API Docs</a></li><li><a href="../../../en/#framework">Features</a></li></ul></li><li class="dropdown"><a class="nav-link scrollto" href="#language-list"><span>Language</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="../../../en">English</a></li><li><a href="../../../ja">日本語</a></li><li><a href="../../../cn">简体中文</a></li></ul></li><li class="dropdown"><a class="nav-link"><span>Support US</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="https://github.com/sponsors/Next2D" target="_blank">GitHub</a></li><li><a href="https://www.patreon.com/next2d" target="_blank">patreon</a></li></ul></li><li><a class="nav-link scrollto" href="../../../en/#contact">Contact</a></li></ul><i class="bi bi-list mobile-nav-toggle"></i></nav></div></header><main id="main"><section class="breadcrumbs"><div class="container"><div class="d-flex justify-content-between align-items-center"><h2>Framework API Documentation</h2><ol><li><a href="../../../en">Home</a></li><li>Framework API Documentation</li></ol></div></div></section><section id="docs" class="padd-section"><div class="container" data-aos="fade-up"><div class="row docs" data-aos="fade-up" data-aos-delay="100"><div class="col-md-12 col-lg-3"><div class="search"><input id="search" type="text" class="form-control input-md" placeholder="Search..."><script type="text/javascript">(() =>
        {
            document
                .getElementById("search")
                .addEventListener("keyup", (event) =>
                {
                    const value = event.currentTarget.value.trim();

                    document
                        .getElementById("sub-navbar")
                        .classList.remove("searching");

                    if (value) {

                        const element = document.getElementById("sub-navbar");

                        element.classList.add("searching");

                        const items = document
                            .getElementsByClassName("parent");

                        const regexp = new RegExp(value, "i");

                        // reset
                        for (let idx = 0; idx < items.length; ++idx) {
                            const item = items[idx];
                            item.classList.remove("match", "no-match");

                            let parent = items[idx].parentNode;
                            parent.classList.remove("match", "no-match");

                             parent
                                .parentNode
                                .classList.remove("match", "no-match");
                        }

                        for (let idx = 0; idx < items.length; ++idx) {

                            const item = items[idx];

                            let parent = item.parentNode;
                            if (!item.dataset.name || !regexp.test(item.dataset.name)) {

                                if (!parent.classList.contains("match")) {
                                    parent.classList.add("no-match");
                                }

                                parent = parent.parentNode;
                                if (!parent.classList.contains("match")) {
                                    parent.classList.add("no-match");
                                }

                                item.classList.add("no-match");

                            } else {

                                parent.classList.remove("no-match");
                                parent.classList.add("match");

                                parent = parent.parentNode;
                                parent.classList.remove("no-match");
                                parent.classList.add("match");

                                item.classList.add("match");

                            }
                        }
                    }
                });
        })();</script></div><nav id="sub-navbar" class="sub-navbar"><ul class="list-unstyled"><li class="docs-item"><span class="title"><a href="Content_Content.html">Content#Content</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="View_View.html">View#View</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="application.exports.Application.html">application.exports.Application</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="application.exports.Context.html">application.exports.Context</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="application.service.exports.RemoveResponse.html">application.service.exports.RemoveResponse</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.callback.exports.Callback.html">domain.callback.exports.Callback</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.convert.exports.ToCamelCase.html">domain.convert.exports.ToCamelCase</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.loading.exports.Loading.html">domain.loading.exports.Loading</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.parser.exports.ConfigParser.html">domain.parser.exports.ConfigParser</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.parser.exports.QueryParser.html">domain.parser.exports.QueryParser</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.parser.exports.RequestParser.html">domain.parser.exports.RequestParser</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.screen.exports.Capture.html">domain.screen.exports.Capture</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="domain.screen.exports.DefaultLoading.html">domain.screen.exports.DefaultLoading</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.constant.exports.RequestType.html">infrastructure.constant.exports.RequestType</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.dto.exports.ResponseDTO.html">infrastructure.dto.exports.ResponseDTO</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.repository.exports.ContentRepository.html">infrastructure.repository.exports.ContentRepository</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.repository.exports.CustomRepository.html">infrastructure.repository.exports.CustomRepository</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.repository.exports.JsonRepository.html">infrastructure.repository.exports.JsonRepository</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.service.exports.ContentService.html">infrastructure.service.exports.ContentService</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.service.exports.CustomService.html">infrastructure.service.exports.CustomService</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.service.exports.JsonService.html">infrastructure.service.exports.JsonService</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="infrastructure.usecase.exports.RequestUseCase.html">infrastructure.usecase.exports.RequestUseCase</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li><li class="docs-item"><span class="title"><a href="view.exports.ViewModel.html">view.exports.ViewModel</a></span><ul class="members itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="typedefs itemMembers"></ul><ul class="methods itemMembers"></ul><ul class="events itemMembers"></ul></li></ul><i class="bi bi-list mobile-sub-nav-toggle"></i></nav></div><div class="col-md-12 col-lg-9"><div><div class="page-title" data-filename="application_Application.js.html">Source: application/Application.js</div><section><header><div class="header content-size"><h1>application/Application.js</h1></div></header><article><pre id="source-code" class="prettyprint source linenums"><code>import { Context } from "./Context";
import { ConfigParser } from "../domain/parser/ConfigParser";
import { QueryParser } from "../domain/parser/QueryParser";
import { RequestUseCase } from "../infrastructure/usecase/RequestUseCase";
import { Callback } from "../domain/callback/Callback";
import { Loading } from "../domain/loading/Loading";
import { Capture } from "../domain/screen/Capture";
import { RemoveResponse } from "./service/RemoveResponse";
/**
 * シーン遷移のコントロールを行うクラス。
 * Class for controlling scene transitions.
 *
 * @class
 * @memberof application
 */
export class Application {
    /**
     * @param {object} config
     * @param {array}  packages
     * @constructor
     * @public
     */
    constructor(config, packages) {
        /**
         * @type {object}
         * @static
         */
        // @ts-ignore
        next2d.fw.config = config;
        /**
         * @type {Map}
         * @static
         */
        // @ts-ignore
        next2d.fw.packages = new Map(packages);
        /**
         * @type {Application}
         * @static
         */
        // @ts-ignore
        next2d.fw.application = this;
        /**
         * @type {Context}
         * @static
         */
        // @ts-ignore
        next2d.fw.context = new Context(config.stage.width, config.stage.height, config.stage.fps, config.stage.options);
        /**
         * @type {ConfigParser}
         * @static
         */
        // @ts-ignore
        next2d.fw.parser = new ConfigParser();
        /**
         * @type {QueryParser}
         * @private
         */
        this._$queryParser = new QueryParser();
        /**
         * @type {RequestUseCase}
         * @private
         */
        this._$requestUseCase = new RequestUseCase();
        /**
         * @type {Callback}
         * @private
         */
        this._$callback = new Callback();
        /**
         * @type {Loading}
         * @private
         */
        this._$loading = new Loading();
        /**
         * @type {Capture}
         * @private
         */
        this._$capture = new Capture();
        /**
         * @type {RemoveResponse}
         * @private
         */
        this._$removeResponse = new RemoveResponse();
        /**
         * @type {boolean}
         * @default false
         * @private
         */
        this._$popstate = false;
        /**
         * SPAが有効の場合は、遷移の履歴を残す
         * Keep history of transitions if SPA setting is enabled
         */
        if (config.spa) {
            window.addEventListener("popstate", () => {
                this._$popstate = true;
                this.gotoView();
            });
        }
        /**
         * @type {string}
         * @default "top"
         * @private
         */
        this._$currentName = "top";
        // initial processing
        this.initialize();
    }
    /**
     * @description constructorが起動した後にコールされます。(初回起動時のみコールされます。)
     *              Called after the constructor is invoked. (Called only the first time it is invoked.)
     *
     * @return {void}
     * @method
     * @abstract
     */
    // eslint-disable-next-line no-empty-function
    initialize() { }
    /**
     * @description 指定のViewを起動して、描画を開始します。引数を指定しない場合はURLをパースしてViewを起動します。
     *              Launches the specified View and starts drawing. If no argument is specified,
     *              the URL will be parsed and the View will be launched.
     *
     * @param  {string} [name=""]
     * @return {Promise&lt;void>}
     * @method
     * @public
     */
    gotoView(name = "") {
        // @ts-ignore
        const config = next2d.fw.config;
        const promises = [];
        if (config.loading) {
            /**
             * ローディング表示を起動
             * Launch loading display
             */
            this._$loading.start();
            /**
             * 現時点の描画をBitmapにして処理の負担を減らす
             * Reduce the processing burden by making the current drawing a Bitmap.
             */
            promises.push(this._$capture.execute());
        }
        return Promise
            .all(promises)
            .then(() => {
            /**
             * 前の画面で取得したレスポンスデータを初期化
             * Initialize the response data obtained on the previous screen
             */
            this
                ._$removeResponse
                .execute(this._$currentName);
            return Promise.resolve();
        })
            .then(() => {
            /**
             * 指定されたパス、もしくはURLからアクセス先を算出
             * Calculate the access point from the specified path or URL
             */
            const object = this._$queryParser.execute(name);
            this._$currentName = object.name;
            /**
             * 遷移履歴をセット
             * Set transition history
             */
            if (config.spa &amp;&amp; !this._$popstate) {
                history.pushState("", "", `${location.origin}/${this._$currentName}${object.queryString}`);
            }
            // update
            this._$popstate = false;
            return Promise.resolve();
        })
            .then(() => {
            /**
             * routing.jsonで設定したリクエスト処理を実行
             * Execute request processing set by routing.json
             */
            return Promise
                .all(this._$requestUseCase.execute(this._$currentName));
        })
            .then((responses) => {
            /**
             * レスポンス情報をマップに登録
             * Response information is registered on the map
             */
            // @ts-ignore
            const response = next2d.fw.response;
            for (let idx = 0; idx &lt; responses.length; ++idx) {
                const object = responses[idx];
                if (!object.name) {
                    continue;
                }
                response.set(object.name, object.response);
            }
            return Promise.resolve();
        })
            .then(() => {
            /**
             * ViewとViewModelを起動
             * Start View and ViewModel
             */
            return Promise.resolve(
            // @ts-ignore
            next2d.fw.context.addChild(this._$currentName));
        })
            .then((view) => {
            // @ts-ignore
            const config = next2d.fw.config;
            /**
             * コールバック設定があれば実行
             * Execute callback settings if any.
             */
            const promises = [];
            if ("gotoView" in config) {
                promises.push(this._$callback.execute(config.gotoView.callback, view));
            }
            return Promise.all(promises);
        })
            .then(() => {
            /**
             * ローディング表示を終了
             * End loading display
             */
            this._$loading.end();
        });
    }
}
</code></pre></article></section><script type="text/javascript">(() =>
    {
        let counter = 1;

        const source = document.getElementById("source-code");
        if (source) {
            const code = source.getElementsByTagName("code")[0];

            let numbered = code.innerHTML.split("\n");
            numbered = numbered.map((item) =>
            {
                return `<li id="line${counter++}"><code>${item}</code></li>`;
            });

            code.remove();

            const ol = document.createElement("ol");
            ol.classList.add("linenums");

            source.appendChild(ol);
            ol.innerHTML = numbered.join("");
        }

    })();</script></div></div></div></div></section></main><footer class="footer" data-aos="fade-up"><div class="container"><div class="row"><div class="col-md-12 col-lg-4"><div class="footer-logo"><a class="navbar-brand" href="../../../en">Next2D</a><p>Next2D, a project derived from the JavaScript FlashPlayer &quot;swf2js&quot;, aims to provide the fastest 2D engine that works on any device.<br>Created by Toshiyuki Ienaga.</p></div><div class="list-sns-menu"><ul class="list-unstyled"><li><a href="https://twitter.com/ienagatoshiyuki" target="_blank"><i class="bi bi-twitter"></i></a></li><li><a href="https://github.com/ienaga" target="_blank"><i class="bi bi-github"></i></a></li></ul></div></div><div class="col-sm-6 col-md-3 col-lg-2"><div class="list-menu"><h4>Player</h4><ul class="list-unstyled"><li><a href="https://github.com/Next2D/Player" target="_blank">GitHub</a></li><li><a href="../../../en/docs/player">API Docs</a></li><li><a href="../../../en/reference/player">Reference</a></li><li><a href="../../../en/#player">Features</a></li></ul></div></div><div class="col-sm-6 col-md-3 col-lg-2"><div class="list-menu"><h4>Tool</h4><ul class="list-unstyled"><li><a href="https://tool.next2d.app" target="_blank">Web Site</a></li><li><a href="../../../en/usage">Usage</a></li><li><a href="https://www.youtube.com/channel/UCKWvYSKSa8huzkr9T6GAPUw/videos" target="_blank">YouTube</a></li><li><a href="../../../en/docs/tool">API Docs</a></li><li><a href="../../../en/#tool">Features</a></li><li><a href="https://github.com/Next2D/tool.next2d.app/tree/develop" target="_blank">GitHub</a></li></ul></div></div><div class="col-sm-6 col-md-3 col-lg-2"><div class="list-menu"><h4>Framework</h4><ul class="list-unstyled"><li><a href="https://github.com/Next2D/Framework" target="_blank">GitHub</a></li><li><a href="../../../en/docs/framework">API Docs</a></li><li><a href="../../../en/#framework">Features</a></li></ul></div></div><div class="col-sm-6 col-md-3 col-lg-2"><div class="list-menu"><h4>About US</h4><ul class="list-unstyled"><li><a href="../../../en/#contact">Contact</a></li><li><a href="../../../en/privacy">Privacy Policy</a></li></ul></div></div></div></div><div class="copyrights"><div class="container"><p>&copy; Copyrights Next2D. All rights reserved.</p></div></div></footer><a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a><script src="../../../assets/vendor/aos/aos.js"></script><script src="../../../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script src="../../../assets/js/main.min.js"></script><script type="text/javascript">(() =>
    {
        const filename = document
            .getElementsByClassName("page-title")[0]
            .dataset.filename
            .replace(".html", "");

        const items = document
            .getElementsByClassName("docs-item");

        for (let idx = 0; idx < items.length; ++idx) {

            const item = items[idx];
            if (item.firstChild.textContent !== filename) {
                continue;
            }

            item.classList.add("current");
            if (idx) {
                const parent = item.parentNode;
                item.remove();
                parent.insertBefore(item, items[0]);
            }

            break;
        }

    })();</script></body></html>